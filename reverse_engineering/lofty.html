<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <meta charset="utf-8">
    <title>Los Fachmënn</title>
    <meta name="viewport" content="width=device-width, minimum-scale=1.0" />
    <meta author="Los Fachmënn" />
    <meta property="og:image" content="../assets/preview.png" />

    <link rel="shortcut icon" href="../assets/icons/computer-3.png" type="image/png">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

    <link rel="stylesheet" type="text/css" href="../assets/win95.css">
</head>

<body class="windows-scrollbar">

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light navbar-95 ">
        <a class="navbar-brand" href="#">
            <img src="../assets/icons/computer-3.png"> Navbar</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavDropdown">
            <ul class="navbar-nav">
                <li class="nav-item active">
                    <a class="nav-link" href="../index.html">Home<span class="sr-only">(current)</span></a>
                    <a class="nav-link" href="reverse_engineering.html">RE Projects<span class="sr-only">(current)</span></a>
                    <a class="nav-link" href="../measuring/measuring.html">Measuring games<span class="sr-only">(current)</span></a>
                </li>
            </ul>
        </div>
    </nav>

    <!-- Header -->

    <div class="pricing-header px-3 py-3 pt-md-5 pb-md-0 mx-auto text-center">
        <h1 class="display-4">Los Fachmënn</h1>
        <p class="lead">We bake breadsticks</p>
    </div>

    <!-- Not header -->

    <div class="container">
        <div class="row mb-5">
            <div class="col-md-8 text-center">
            </div>
            <div class="col-md-10 my-auto">
                <div class="card">
                    <div class="card-header">
                        <h4 class="my-0 font-weight-normal">Reversing Lofty Loader</h4>
                    </div>
                    <div class="card-body">
                        <ul class="list-unstyled mt-0 mb-2">
                            <img src="../assets/lofty1.png" height="400" width="400" class="center"></img>
                            <br>
                            <li>I first scanned the exe file with Ghidra, with all the settings enabled except the experimental ones</li>
                            <li>Upon scanning and looking at the strings, you can notice they are protected by a packer.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mb-5">
            <div class="col-md-8 text-center">
            </div>
            <div class="col-md-10 my-auto">
                <div class="card">
                    <div class="card-header">
                        <h4 class="my-0 font-weight-normal">Looking at the functions</h4>
                    </div>
                    <div class="card-body">
                        <ul class="list-unstyled mt-0 mb-2">
                            <img src="../assets/lofty2.png" height="250" width="450" class="center"></img>
                            <br>
                            <li>You may also notice the functions are all undefined and there's a lot of space between them.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mb-5">
            <div class="col-md-8 text-center">
            </div>
            <div class="col-md-10 my-auto">
                <div class="card">
                    <div class="card-header">
                        <h4 class="my-0 font-weight-normal">Unpacking with x32dbg</h4>
                    </div>
                    <div class="card-body">
                        <ul class="list-unstyled mt-0 mb-2">
                            <img src="../assets/lofty4.png" height="200" width="700" class="center"></img>
                            <br>
                            <li>The program gets to this point in memory then crashes with an exception. In order to allow us to view more steps, we go to preferences in the debugger and make do a breakpoint in Thread Entries and Thread Starts</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mb-5">
            <div class="col-md-8 text-center">
            </div>
            <div class="col-md-10 my-auto">
                <div class="card">
                    <div class="card-header">
                        <h4 class="my-0 font-weight-normal">Final step</h4>
                    </div>
                    <div class="card-body">
                        <ul class="list-unstyled mt-0 mb-2">
                            <img src="../assets/lofty5.png" height="200" width="700" class="center"></img>
                            <br>
                            <li>Now we simply change instruction 0x77825900, which crashes the program, into jmp 0x77825902, which allows it to run for a little longer, allowing ghidra to analyze more functions. After this, we patch it and analyze it on Ghidra, and done. Everything that follows is just logical analysis based on figuring out common microsoft functions, naming the variables properly, and using them to guess what the functions do.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    

    <!-- Footer -->
    <footer class="taskbar">
        <div class="row" style="margin-right: 0px;">
            <div class="col-8">
                <a href="https://www.roblox.com/groups/5529343/Los-Fachm-nn#!/about" class="btn start-button"><img src="../assets/oldrobloxicon.png" class="icon-16"> Roblox group</a>
            </div>
            <div class="col-4 time">Los Fachmënn</div>
        </div>

    </footer>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
</body>

</html>
